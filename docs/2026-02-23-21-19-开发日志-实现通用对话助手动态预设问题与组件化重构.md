# 2026-02-23-21-19-开发日志-实现通用对话助手动态预设问题与组件化重构

## 1. 背景 (Background)

为了提升 General Chat 的交互质量与功能引导性，我们需要让首页的“推荐问题”不再僵化。目标是建立一套能够感知当前模型能力（1T/Flash/Mini）并实时响应工具状态（VFS/JS）的智能化建议系统。

## 2. 来源文档 (Source)
- [[2026-02-23-21-06-设计-通用对话系统动态预设问题组件化开发计划.md]]

## 3. 主要工作 (Major Accomplishments)

### 3.1 动态建议引擎 (Suggestion Engine)
- **多维度感知**: 实现了 `SuggestionProvider.ts` 逻辑层，根据模型 ID 关键词自动切换“深度解析”（1T）、“快速科普”（Flash）与“处理类”（Mini）问题库。
- **智能挤占逻辑**: 设计并实现了工具状态驱动的问题替换方案。当 VFS 或 JS 工具开启时，系统会自动“挤掉”基础问题，优先展示工具专属建议。
- **本地化与精简**: 所有预设问题均已翻译为英文，并针对 VFS 场景加入了 “(see FS tab)” 和 “(current session only)” 等实用提示。

### 3.2 架构重构与组件化
- **UI 抽离**: 将 `ThreadSuggestions` 从大型文件 `thread.tsx` 中彻底抽离，建立了独立的组件目录。
- **状态解耦**: UI 组件通过 `useModelStore` 实时监听模型与工具变化，实现了零配置的自动刷新。

### 3.3 系统模型配置优化
- **清理冗余**: 移除了 `lib/model.ts` 中不再使用的 `Ring_1T` 模型定义。
- **默认值同步**: 确保全局默认模型保持在稳定的 `Ling_1T` 版本。

## 4. 遇到的问题与修正 (Issues & Fixes)

- **状态不刷新**: 初始实现中工具 ID 匹配逻辑过于严格，导致 checkbox 勾选后 UI 无变化。通过分析 `ModelConfig` 将匹配规则修正为简洁的 `vfs` 和 `js` 后解决。
- **导入冲突**: 在重构过程中清理了不再使用的 inline 常量，提升了代码的维护性。

## 5. 结论 (Next Steps)
General Chat 现已具备高度的功能感知能力，能够引导用户探索不同等级模型的最佳使用场景。
下一步：
- [ ] **多语言支持**: 建立 i18n 机制以支持建议库的动态多语言切换。
- [ ] **历史感应**: 基于用户最近的一次对话意图，动态预测并更新下一轮的推荐问题。
