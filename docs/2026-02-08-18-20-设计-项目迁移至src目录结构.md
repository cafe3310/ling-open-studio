# 2026-02-08-18-20-设计-项目迁移至src目录结构

## 1. 背景 (Background)

在当前的目录结构中，源码（`app`, `components`, `lib` 等）与非代码资源（`docs`, `public`）共同存放在根目录下。这导致了以下问题：
- **构建工具干扰**：Tailwind CSS v4 在执行自动扫描时会误入 `docs/` 目录，尝试将文档中的文本解析为 CSS 类，导致构建错误或产生冗余样式。
- **结构不清晰**：随着项目复杂度增加，源码目录与配置文件混杂，不利于维护。

## 2. 目标 (Goal)

通过引入标准的 `src/` 目录结构，实现源码与资源的**物理隔离**。
- 确保构建工具（Tailwind, TypeScript）默认只关注 `src/` 目录。
- 遵循 Next.js 社区推荐的最佳实践。

## 3. 操作步骤 (Detailed Steps)

### 3.1 目录准备
1. 创建 `src/` 目录。
2. 将以下源码目录移动到 `src/` 下：
   - `app/` -> `src/app/`
   - `assistants/` -> `src/assistants/`
   - `components/` -> `src/components/`
   - `hooks/` -> `src/hooks/`
   - `lib/` -> `src/lib/`

*注意：`public/`, `docs/`, `node_modules/` 以及根目录下的配置文件（如 `package.json`, `next.config.ts`, `tsconfig.json`）保持不动。*

### 3.2 更新 TypeScript 配置 (`tsconfig.json`)
修改 `paths` 映射，确保 `@/*` 别名指向 `src/` 内部。
```json
"paths": {
  "@/*": ["./src/*"]
}
```

### 3.3 更新 Shadcn UI 配置 (`components.json`)
更新组件和工具库的路径引用：
- `tailwind.config.js` -> 保持原有（或移除，如果使用 v4 纯 CSS 模式）。
- `aliases` 部分的 `components`, `utils`, `ui`, `hooks` 路径前缀均增加 `src/`。
- `tailwind.css` 路径更新为 `src/app/globals.css`。

### 3.4 检查 Tailwind CSS 扫描路径
在 Tailwind CSS v4 中，将 `app/globals.css` 移动到 `src/app/globals.css` 后，它默认会扫描其所在的 `src/` 目录及其子目录。
- 验证是否需要显式的 `@source` 指令。
- 确认 `docs/` 目录已被天然排除。

### 3.5 环境变量与中间件
- 检查 `middleware.ts`（如果存在），需移动至 `src/middleware.ts`。
- 检查 `next.config.ts` 中是否有硬编码的路径。

## 4. 预期影响 (Expected Impact)

- **性能提升**：构建工具扫描的文件数量显著减少。
- **错误修复**：彻底解决 Tailwind 扫描 `docs/` 导致的构建冲突。
- **开发体验**：IDE 的文件搜索和导航将更加聚焦。

## 5. 验证清单 (Verification)

- [ ] 运行 `pnpm dev` 验证应用能否正常启动。
- [ ] 运行 `pnpm build` 验证生产环境构建无路径错误。
- [ ] 检查生成的 CSS 文件，确认不再包含来自 `docs/` 的误匹配类名。
