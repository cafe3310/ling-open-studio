# 演示项目：特性设计草案 (Blueprint Draft) v2

## 1. 核心定位
展示特定模型家族（用户自有模型）在不同尺寸、不同场景下的多面能力。采用 **多 Tab / 多页面** 结构，每个页面针对一种核心能力。

## 2. 核心功能模块

### 2.1 模块一：基础对话 (Model Chat)
**目标**：展示模型的基础指令遵循、对话流畅度与参数敏感性。
**布局**：经典三栏布局 (左-中-右)。
- **左侧 (Sidebar)**：对话历史记录 (History)。
    - 功能：新建对话、切换历史会话、删除会话。
- **中间 (Main)**：对话交互区 (Chat Interface)。
    - 功能：气泡式对话流、输入框、流式响应展示。
- **右侧 (Settings)**：模型控制面板。
    - **模型选择**：选择不同的模型尺寸 (e.g., Nano, Small, Large)。
    - **系统提示词 (System Prompt)**：用户可自定义 System Prompt。
    - **参数设置**：温度 (Temperature)、最大 Token 数等。

### 2.2 模块二：网页生成 (Model Web)
**目标**：展示模型的代码生成能力与前端理解力 (类似 v0 或 OSW 的简化版)。
**布局**：三栏布局。
- **左侧 (Chat)**：生成指令对话区。
    - 功能：输入需求 (e.g., "做一个登陆页面")，显示模型的思考与代码生成过程。
- **中间 (Preview)**：产物预览区。
    - 功能：实时渲染生成的 HTML/React 代码。支持 Desktop/Mobile 视图切换。
- **右侧 (Config)**：生成偏好设置。
    - **风格预设**：选择视觉风格 (e.g., Modern, Minimal, Brutalist)。
    - **框架选择**：前端技术栈 (e.g., HTML/Tailwind, React/Shadcn)。

### 2.3 模块三：辅助写作 (Model Write)
**目标**：展示模型在长文本创作、逻辑梳理、实体提取及灵感激发方面的综合能力。
**布局**：三栏布局。

#### 左侧：故事设定 (Story Context)
- **故事元数据**：标题、大纲、世界观摘要。世界观设定、角色设定、写作大纲、语气风格。
- **控制区**：
    - **生成一段**：基于当前光标位置或章节末尾，生成下一个段落。
    - **生成全部**：尝试基于大纲生成完整章节（流式长文本）。

#### 中间：纯文本编辑器 (The Editor)
- **UI**：极简纯文本编辑器 (类似 Typora 源码模式或 Word 纯文本模式)。
- **交互**：
    - **手动输入**：用户自由打字。
    - **单句续写**：光标处触发（快捷键或悬浮球），AI 补全一句话或一个短句。
    - **插入灵感**：响应右侧灵感卡片的点击事件。

#### 右侧：智能辅助 (AI Insights)
- **动态实体库 (Live Concepts)**：
    - 机制：后台静默任务 (Background Task) 每隔一段时间（或手动触发）分析编辑器全文。
    - 展示：自动提取的“主角”、“关键物品”、“地点”等概念列表。
- **灵感卡片 (Inspiration Cards)**：
    - 机制：模型根据当前上下文，推荐 3-5 个后续情节发展方向或描写片段。
    - 交互：点击卡片，将建议内容直接插入到编辑器光标处。

## 3. 技术架构决策

### 3.1 API 协议
- **标准**：OpenAI Compatible API。
- **鉴权**：API Key 存储于 Hugging Face Spaces Secrets (`HF_TOKEN` 或自定义变量名)，前端通过 Server Action 或 Proxy 路由调用，**不暴露 Key 给客户端**。

### 3.2 关键技术选型
- **Model Chat & Web**: 复用 `osw-studio` 的 `ChatPanel` 和 `Preview` 组件（需剥离 VFS 强依赖，改为内存 VFS 或直接传递字符串）。
- **Model Write Editor**: 建议使用 `Monaco Editor` (已集成) 的简化模式，或者 `Textarea` + 自动调整高度，以保持“纯文本”的最简体验。
- **后台分析任务**: 利用 React `useEffect` + `Debounce` (防抖) 在前端触发，或者 Web Worker，调用独立的 LLM 请求来提取实体和生成灵感，**不阻塞**主编辑器的输入。

## 4. 数据流设计
- **User Input** -> **Next.js API Route (Proxy)** -> **Model API**
- **Stream Response** -> **Client UI Update**