# OSW Studio：全量路由清单 (Pages & APIs)

## 背景
基于用户需要完整掌握 `osw-studio` 项目的所有页面和 API 路由分布的需求。

## 1. 前端页面路由 (Frontend Pages)
项目采用 Next.js App Router，所有页面均为 `page.tsx`。

### 1.1 核心工作流
- `/` (`app/page.tsx`): **应用主入口**。浏览器模式下加载 Studio 界面，服务器模式下重定向至后台。
- `/test-generation` (`app/test-generation/page.tsx`): **模型测试页**，用于验证 LLM 供应商的兼容性。

### 1.2 后台管理 (`/admin/*`)
- `/admin` (`app/admin/page.tsx`): 管理端首页。
- `/admin/login` (`app/admin/login/page.tsx`): 管理员登录页。
- `/admin/dashboard` (`app/admin/dashboard/page.tsx`): 系统概览与流量统计。
- `/admin/projects` (`app/admin/projects/page.tsx`): 项目列表管理。
- `/admin/sites` (`app/admin/sites/page.tsx`): 站点发布状态管理。
- `/admin/templates` (`app/admin/templates/page.tsx`): 项目模板管理。
- `/admin/skills` (`app/admin/skills/page.tsx`): AI 技能管理。
- `/admin/docs` (`app/admin/docs/page.tsx`): 项目内联文档。
- `/admin/settings` (`app/admin/settings/page.tsx`): 常规设置。
    - `/admin/settings/application`: 应用基础配置。
    - `/admin/settings/model`: 默认模型与供应商配置。

---

## 2. 后端 API 路由 (Backend APIs)
所有接口均为 `route.ts`。

### 2.1 AI 与 核心逻辑
- `POST /api/generate`: **最核心接口**。处理对话、代码生成及工具调用。
- `GET /api/models`: 获取已配置供应商的可用模型列表。
- `POST /api/validate-key`: 验证 API Key 的有效性。
- `POST /api/shell/execute`: 执行虚拟终端命令。

### 2.2 站点发布与访问 (`/sites/*`)
- `GET/POST /sites/[id]`: 访问已发布的站点内容。
- `GET /sites/[id]/[...path]`: 处理静态站点内部文件的路由重定向。

### 2.3 认证系统 (`/api/auth/*`)
- `POST /api/auth/login`: 登录。
- `POST /api/auth/logout`: 登出。
- `GET /api/auth/me`: 获取当前登录用户信息。
- `GET /api/auth/check`: 检查 Session 有效性。

### 2.4 数据同步 (`/api/sync/*`)
- `/api/sync/status`: 检查浏览器与服务器同步状态。
- `/api/sync/files`: 同步文件系统变更。
- `/api/sync/projects`: 同步项目元数据。
- `/api/sync/projects/[id]`: 同步单个项目。
- `/api/sync/templates`: 同步模板。
- `/api/sync/skills`: 同步 AI 技能。

### 2.5 站点精细化管理 (`/api/sites/*`)
- `GET/PATCH /api/sites/[id]`: 获取/更新站点元数据。
- `POST /api/sites/[id]/publish`: 执行站点发布流程。
- `PATCH /api/sites/[id]/settings`: 更新站点 SEO、分析等设置。
- `GET /api/sites/[id]/thumbnail`: 获取站点缩略图。
- `ANY /api/sites/[id]/functions/[...path]`: **Edge Functions** 运行时入口。

### 2.6 数据分析 (`/api/analytics/*`)
- `POST /api/analytics/track`: 记录基础访问事件。
- `POST /api/analytics/interaction`: 记录热力图等交互数据。
- `GET /api/analytics/[siteId]/overview`: 统计概览。
- `GET /api/analytics/[siteId]/sessions`: 访客会话列表。
- `GET /api/analytics/[siteId]/engagement`: 参与度指标。
- `GET /api/analytics/[siteId]/heatmap`: 获取交互热力图数据。
- `DELETE /api/analytics/[siteId]/clear`: 清空分析数据。

### 2.7 服务器模式特有接口 (`/api/admin/*`)
- `GET /api/admin/dashboard`: 获取全局统计数据（CPU、内存、总流量）。
- `POST /api/admin/run-migrations`: 数据库初始化与迁移。
- `GET /api/admin/sites/[id]/database/schema`: 获取站点 SQLite 结构。
- `POST /api/admin/sites/[id]/database/query`: 执行 SQL 查询。
- `GET /api/admin/sites/[id]/database/logs`: 数据库操作日志。
- `/api/admin/sites/[id]/secrets`: 管理站点加密密钥。
- `/api/admin/sites/[id]/functions`: 管理该站点的 Edge Functions。
- `/api/admin/sites/[id]/server-functions`: 管理服务端函数。
- `/api/admin/sites/[id]/server-context`: 获取/修改站点的 Server Context（AI 感知用）。
