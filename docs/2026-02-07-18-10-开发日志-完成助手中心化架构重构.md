# 2026-02-07-18-10-开发日志-完成助手中心化架构重构

## 1. 背景 (Background)
随着 Model Web 等复杂业务逻辑的引入，原有的扁平化目录结构（`app/lib/assistants`）在扩展性和隔离性上显得不足。为了对齐 `ling-model-judge` 的优秀实践，今日对项目进行了“以助手为中心”的架构重构。

## 2. 完成的工作 (Accomplishments)

### 2.1 目录结构重组
- **`assistants/` 根目录**: 建立了统一的业务逻辑存放点。
    - `general-chat/`: 存放通用对话逻辑。
    - `web-architect/`: 为网页生成助手预留了完整结构。
    - `naming/`: 存放自动命名逻辑。
- **共享 `lib/` 优化**:
    - `lib/assistant-utils/`: 存放跨助手的公用工具（如 `reasoning-splitter.ts`）。
    - `lib/tools/`: 建立了工具链开发区。
    - 统一将 `model.ts` 等基础设施移至根级 `lib/`。

### 2.2 动态调度机制 (Assistant Registry)
- **实现 `assistants/registry.ts`**: 引入了助手注册表模式。根据请求的 `mode` (chat, web-gen) 动态路由到不同的 LangGraph 实例。
- **解耦 API 路由**: `/api/chat/route.ts` 不再硬编码某个 Graph，而是通过注册表进行调度，极大地提升了系统的可扩展性。

### 2.3 导入路径修复
- 全量清理了旧的 `@/app/lib/...` 引用，修复了所有因文件移动导致的编译错误。

## 3. 架构优势
1.  **独立迭代**: 网页生成的复杂 Graph 可以独立在 `web-architect` 目录下进行闭环开发，不影响主聊天功能。
2.  **清晰的职责边界**: 基础设施 (Infrastructure)、业务逻辑 (Assistants) 与 UI 组件 (Components) 的分层更加明确。

## 4. 后续计划 (Next Steps)
- **Tooling Implementation**: 在 `lib/tools/` 实现通用的 VFS 工具和 Tool Calling Helper。
- **WebGen Graph**: 在 `assistants/web-architect/` 下实现正式的网页生成逻辑。
