# 提示词中心化重构编辑计划 (Refactoring Edit Plan)

## 阶段一：基础设施搭建 (Infrastructure)

1. **创建基础目录**:
   - `apps/studio/src/lib/prompts/shared`
   - `apps/studio/src/lib/prompts/assistants`
   - `apps/studio/src/lib/prompt-engine/stitchers`

2. **迁移通用片段 (Shared)**:
   - 提取 `initial-gen.ts` 和 `designs.ts` 中关于 Lucide 和 Tailwind 的通用指导到 `shared/ui-guidelines.ts`。
   - 创建 `shared/constraints.ts` 定义基础输出约束。

3. **迁移工具协议 (Tools Protocol)**:
   - 提取 `lib/tools/ctx-*.ts` 中的文本片段到 `shared/protocols/`。

## 阶段二：助手提示词迁移 (Assistant Migration)

1. **Naming Assistant**:
   - 迁移 `apps/studio/src/assistants/naming/graph.ts` 的提示词。

2. **Web Architect (Data)**:
   - 将 `apps/studio/src/assistants/web-architect/prompts/*` 迁移至 `apps/studio/src/lib/prompts/assistants/web-architect/data/`。

3. **Web Architect (Templates)**:
   - 将 `initial-gen.ts` 和 `refine-gen.ts` 中的 5 个模板迁移至 `apps/studio/src/lib/prompts/assistants/web-architect/`。

## 阶段三：引擎重构 (Engine Refactoring)

1. **重构 Stitching 逻辑**:
   - 将 `lib/tools/ctx-*.ts` 中的拼接方法移动到 `lib/prompt-engine/stitchers/`。
   - 实现一个统一的 `PromptBuilder`。

2. **更新 API 与 Graph 调用**:
   - 修改 `api/chat/general/route.ts` 使用新的 Builder。
   - 修改 `web-architect` 下的 Nodes，从 `lib/prompts` 导入提示词并使用 Builder。

## 阶段四：清理与验证 (Cleanup & Validation)

1. **移除旧目录**: `apps/studio/src/assistants/web-architect/prompts`。
2. **构建测试**: 确保项目可以成功编译。
3. **功能验证**: 手动或自动化测试各助手是否仍能正常生成内容和调用工具。
