# 2026-02-23-21-06-设计-通用对话系统动态预设问题组件化开发计划

## 1. 背景 (Background)
用户需要实现通用对话助手 (`GeneralChatAssistant`) 中 `ThreadSuggestions` 组件的智能化升级：根据当前所选模型的性能级别（1T, Flash, Mini）及启用的工具状态（VFS, JS），动态呈现四个针对性强、符合语境的预设问题。

## 2. 设计规范 (Design Specs)

### 2.1 基础问题库 (按模型能力)
*   **1T (高推理)**: 侧重深度解析、哲学探讨、复杂逻辑。
*   **Flash (中性能)**: 侧重快速科普、生活常识、基础编程。
*   **Mini (高效率)**: 侧重字符串处理、简单代码生成、格式转换。

### 2.2 工具专属问题 (按功能)
*   **VFS (虚拟文件系统)**: 文件浏览、内容读取、文件创建。
*   **JS (JavaScript 环境)**: 复杂运算、性能测试、算法实现。

### 2.3 动态编排规则
*   固定展示 4 个问题。
*   **优先级挤占**: 
    1.  若 VFS 开启，替换最后 2 个基础问题。
    2.  若 JS 开启，替换剩余 2 个基础问题（若 VFS 已开启）或最后 2 个基础问题（若 VFS 未开启）。
    3.  最终确保 VFS 和 JS 问题在开启时优先显示。

## 3. 实施步骤 (Implementation Steps)

### 第一阶段：组件抽离与目录建立
1.  创建目录 `apps/studio/src/components/assistants/general-chat/suggestions/`。
2.  创建 `SuggestionProvider.ts`: 存放问题定义与计算逻辑。
3.  创建 `ThreadSuggestions.tsx`: 独立的 UI 组件。

### 第二阶段：逻辑开发
1.  **Provider 实现**: 
    *   定义 `getSuggestions(modelId, enabledTools)` 函数。
    *   通过对 `modelId` 进行关键词匹配（1T, Flash, Mini）确定基础池。
2.  **UI 组件实现**:
    *   接入 `useModelStore` 获取实时状态。
    *   渲染 4 个 `ThreadPrimitive.Suggestion`。

### 第三阶段：集成与清理
1.  修改 `thread.tsx`:
    *   移除 inline 的 `ThreadSuggestions` 和 `SUGGESTIONS`。
    *   引入并使用新组件。

## 4. 验证与测试
1.  切换模型为 `Ling-2.5-1T`，验证是否出现深度讲解类问题。
2.  开启 VFS 工具，验证最后两个问题是否变为文件系统相关。
3.  开启 JS 工具，验证基础问题是否被进一步挤占。
