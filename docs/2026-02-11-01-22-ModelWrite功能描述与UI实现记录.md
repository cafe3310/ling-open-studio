# 2026-02-11-01-22-ModelWrite功能描述与UI实现记录

这份文档记录了用户与 Agent 之间关于 Model Write 写作助手的详细 UI 功能讨论及其增量实现过程。

## 第一部分：经典等宽编辑器 (The Mono Editor)

### 1.1 用户描述
- **字体**: 使用 Classic Mono 字体 (JetBrains Mono / Monospace)。
- **格式**: 纯文本，不需要带任何格式或渲染。
- **核心特性**: 文末包含 Ghost Text (幻影文字)，表示 AI 的续写预测。
- **交互要求**: 具备点击交互（虽然目前无后端功能）。

### 1.2 UI 实现要点
- 移除原本的 Prose/Serif 样式。
- 建立基于等宽字体的写作画布。
- 实现一个半透明的“续写分量”组件。
- **交互要求**: 具备点击交互。

## 第二部分：左侧边栏 (The Sidebar)

### 2.1 用户描述
- **头部修改**: 移除原本的作品大标题。
- **介绍文字**: 放置一段简介——“由 Ling 系列不同尺寸模型综合驱动的写作助手”。

### 2.2 UI 实现要点
- 更新 Sidebar 顶部区域。
- 采用低调且专业的文字排版。

## 第三部分：摘要与设定 (Summary & Plot)

### 3.1 用户描述
- **Summary 区块**: 允许用户输入和随时修改。点击展开 Modal。
- **点击展开 (Modal)**: 在侧边栏显示一个微型预览块，点击后弹出大 Modal。
- **编辑体验**: Modal 内提供 Mono 字体的编辑区。，支持丰富的 Summary 和 Plot 编写。
- **编辑体验**: Modal 内提供 Mono 字体的编辑区。
- **引导文案**: 明确告知用户“可以简略描述，也可以提供详尽的情节大纲”。

### 3.2 UI 实现要点
- 使用 Shadcn UI 的 Dialog 组件实现 Modal。
- 实现侧边栏的预览卡片样式。

### 3.3 交互修正记录
- **可点击感增强**: 主界面 Summary 区域增加微弱背景色与边框交互，明确暗示其可点击性。
- **等宽字体应用**: Modal 内的 Textarea 强制使用 Mono 字体，与主编辑器体验保持一致。

## 第四部分：统一条目管理 (Unified Entry Management)

### 4.1 用户描述
- **覆盖区域**: World Settings, Concepts, Characters。
- **核心交互**:
    - 侧边栏展示条目名称。
    - 点击条目弹出详情 Modal。
    - 包含 `+` 按钮支持手动新增。
- **条目状态区分**:
    - **实色条目 (Manual)**: 用户手动创建或已认可的条目。
    - **浅色条目 (Auto)**: AI 后台自动识别的条目，视觉上更淡。
- **转正机制**: 点击 AI 识别条目可进行“认可 (Approve)”，点击后该条目转为实色手动条目。

### 4.2 UI 实现要点
- 定义统一的 `EntryList` 组件结构。
- 实现浅色/实色的视觉对比。
- **交互**: 侧边栏展示名称，点击弹出详情。
- **状态区分**: 实色 (Manual) vs 浅色 (Auto-detected)。

## 第五部分：AI 辅助内容整理 (AI-Assisted Drafting)

### 5.1 用户描述
- **详情弹窗增强**: 即使是手动条目，内部也支持 AI 辅助补全。
- **双区结构**: 
    - **用户定义区**: 可编辑的长文本。
    - **AI 建议区**: 展示多个离散的 AI 识别/生成的特性区块（如“它是黄的”、“它是甜的”）。
- **转正逻辑**: 用户点击 AI 建议区块，内容即刻合并至用户定义区。
- **双区结构**: 用户定义区 (Left) + AI 建议区 (Right)。
- **采纳逻辑**: 点击 AI 建议块，内容合并至用户定义区。

### 5.2 UI 实现要点
- 在 Dialog 中引入分栏或分块布局。
- 实现点击建议块追加文本的交互。
- 增加视觉引导，区分已采纳和未采纳的建议（预览阶段暂不处理状态机，仅处理点击交互）。

## 第六部分：自动识别条目的“二段式转正” (Two-stage Approval)

### 6.1 用户描述
- **第一阶段 (未转正)**: 自动识别条目初始只有一个“核心定义”可供采纳。
- **转正交互**: 采纳该核心定义后，条目正式转为手动条目（实色）。
- **第二阶段 (已转正)**: 转正后，系统解锁并展示更多细分的 AI 建议碎片。

### 6.2 UI 实现要点
- `Entry` 结构区分 `initialSnippet` 和后续的 `aiSnippets`。
- 根据 `isAuto` 状态动态控制右侧显示的内容密度。
## 第七部分：灵感卡片的生命周期 (Active Inspirations)

### 7.1 用户描述
- **灵感转正**: 灵感卡片点击后标记为“生效中”。
- **智能联动**: 生效中的卡片明确提示正在影响“续写”和“单句补全”的逻辑。
- **随时撤销**: 允许用户点击“失效”来移除该灵感的持续影响。

### 7.2 UI 实现要点
- 实现卡片的选中状态样式（Active State）。
- 增加“生效中”和“取消”的交互按钮/标签。

## 第八部分：界面精简与布局调整

### 8.1 用户描述
- **移除冗余**: 删除右下角重复的 "Detected Concepts" 区域。
- **清理画布**: 移除页面中央浮动的 "AI Assist" 气泡按钮，保持写作区的极致纯净。

### 8.2 UI 实现要点
- 精简 WriteRightSidebar 和 WriteCanvas 源码。
- 确保视觉重心完全回归到文字本身。

## 第九部分：主动动作触发区 (Right Sidebar Top)

### 9.1 用户描述
- **布局重构**: 将“按钮触发”的功能统一放置在右侧边栏上方。
- **功能包含**:
    - **Continue**: 续写下一段。
    - **Rewrite Selection**: 改写选中部分（需处理选中检测）。
    - **Expand/Condense**: 扩写或精简选中部分。
- **优先级**: 动作区在上，灵感卡片区在下。

### 9.2 UI 实现要点
- 在 WriteRightSidebar 顶部插入 Action 按钮组。
- 增加“未选中”时的状态引导。
